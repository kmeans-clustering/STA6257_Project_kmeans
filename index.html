<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anand Pandey">
<meta name="author" content="Katie Hidden">
<meta name="author" content="Akash Chandra">
<meta name="dcterms.date" content="2022-11-13">
<meta name="description" content="An unsupervised learning algorithm ">

<title>K-Means Clustering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="index_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="index_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span style="color: #0366D6;">K-Means Clustering</span></h1>
</div>

<div>
  <div class="description">
    An unsupervised learning algorithm<br>
    <hr>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Anand Pandey </p>
             <p>Katie Hidden </p>
             <p>Akash Chandra </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 13, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<hr>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>We have often heard of training machine learning models with labeled data. Imagine if there is a massive volume of data with no labels and we want to come up with a scalable approach to process these data and find insights. Difficult as it may seem, this is possible with clustering algorithms like K-Means.</p>
<p>Unsupervised machine learning is a type of algorithm that works on detecting patterns from a dataset when outcomes are not known or labeled. In unsupervised learning models it is not possible to train the algorithm the way we would normally do in case of supervised learning. This is because the data is neither classified nor labeled and allows the algorithm to act on the information without supervision. An unsupervised algorithm works on discovering the underlying hidden structure, pattern or association of the data and that helps the model in clustering or grouping the data without any human intervention.</p>
<p>The main goal of this paper is to discuss the concept and underlying methodology of one the unsupervised algorithm called K-Means clustering. We will also discuss how K-Means can be leveraged in real time applications like customer segmentation <span class="citation" data-cites="yul2020astudy">(<a href="#ref-yul2020astudy" role="doc-biblioref">Yulin 2020</a>)</span>. In this paper, we will also be discussing various limitations and bottlenecks of K-Means clustering algorithm and would suggest some improved algorithms to overcome these limitations.</p>
<section id="k-means-clustering" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="k-means-clustering"><span class="header-section-number">1.1</span> K-Means Clustering</h2>
<p>K-means clustering is used for grouping similar observations together by minimizing the Euclidean distance between them. It uses “centroids”. Initially, it randomly chooses K different points in the data and assigns every data point to their nearest centroid. Once all of them are assigned, it moves the centroid to the average of points assigned to it. When the assigned centroid stops changing, we get the converged data points in separate clusters.</p>
</section>
<section id="customer-segmentation" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="customer-segmentation"><span class="header-section-number">1.2</span> Customer Segmentation</h2>
<p>Customer segmentation helps divide customers into different groups based on their common set of characteristics (like age, gender, spending habit, credit score, etc.) that helps in targeting those customers for marketing purposes. The primary focus of customer segmentation is to come up with strategies that helps in identifying customers in each category in order to maximize the profit by optimizing the services and products. Therefore, customer segmentation helps businesses in promoting the right product to the right customer to increase profits<span class="citation" data-cites="tab2022kmeans">(<a href="#ref-tab2022kmeans" role="doc-biblioref">Tabianan 2022</a>)</span>.</p>
<p>Customer segmentation is not only helpful for business but also helps customers by providing them information relevant to their needs. If customers receive too much information which is not related to their regular purchase or their interest on the products, it can cause confusion on deciding their needs. This might lead their customers to give up on purchasing the items they required and effect the business to lose their potential customers. The clustering analysis will help to categorize the customer according to their spending habit, purchase habit or specific product or brand the customers interested in. Customer segmentation can be broadly divided into four factors - demographic psychographic, behavioral, and geographic<span class="citation" data-cites="tab2022kmeans">(<a href="#ref-tab2022kmeans" role="doc-biblioref">Tabianan 2022</a>)</span>. In this paper, customer behavioral factor has been primarily focused.</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CustomerSegmentation.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image Source: ©Anand</figcaption><p></p>
</figure>
</div>
</center>
<p>K-Means clustering algorithm can help effectively extract groups of customers with similar characteristics and purchasing behavior which in turn helps businesses to specify their differentiated marketing campaign and become more customer-centric.<span class="citation" data-cites="yul2020astudy">(<a href="#ref-yul2020astudy" role="doc-biblioref">Yulin 2020</a>)</span></p>
</section>
<section id="limitations" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="limitations"><span class="header-section-number">1.3</span> Limitations</h2>
<p>One of the challenges of K-means clustering is determining an appropriate number of clusters, or the K-value. While this can be a challenge for datasets of any size, it is especially difficult to determine a reasonable K-value with very large datasets and those with high dimensionality, since it is much more difficult to visualize the data. The K-means clustering algorithm was developed in the 1960s, before the advent of the internet and the resulting era of big data, and as such, it was not designed for datasets of such large scale <span class="citation" data-cites="Sin2020Unsup">(<a href="#ref-Sin2020Unsup" role="doc-biblioref">Sinaga and Yang 2020</a>)</span>.</p>
<p>Another limitation is the algorithm’s tendency to converge to only the local optimum solution, rather than the global minimum. The algorithm is sensitive to the initial centroid values selected, to noise, and to outliers, all of which can cause cluster centers to veer off, resulting in a local minimum solution <span class="citation" data-cites="Jie2020Review">(<a href="#ref-Jie2020Review" role="doc-biblioref">Jie et al. 2020</a>)</span>.</p>
<p>The shape of data clusters is another concern. K-means clustering typically classifies n-hyperspherically shaped data well but is less successful at classifying irregularly shaped clusters <span class="citation" data-cites="Ahmed2020TheK">(<a href="#ref-Ahmed2020TheK" role="doc-biblioref">Ahmed, Seraj, and Islam 2020</a>)</span>.</p>
</section>
<section id="improved-k-means" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="improved-k-means"><span class="header-section-number">1.4</span> Improved K-Means</h2>
<p>Researchers have developed methods to address the limitations of the K-means clustering algorithm.</p>
<p>One popular approach to determining an appropriate K-value is to use the “elbow method”. This method estimates K by calculating the sum of squared error (SSE) for a range of K-values; the SSE values are plotted against the K values. The point before the change in SSE becomes visually minimal (the elbow) is selected as the K-value <span class="citation" data-cites="Nag2022Auto">(<a href="#ref-Nag2022Auto" role="doc-biblioref">Nagaraj et al. 2022</a>)</span>.</p>
<p>To overcome the challenge of selecting a K-value for very large datasets, researchers have developed a “novel unsupervised k-means (U-k-means) clustering algorithm.” This algorithm has a built-in process to determine the K-value and perform K-means clustering using the concept of entropy, and thus does not require any parameter initialization by the user. On the first iteration, the K-value is initialized as the number of data points. Gradually, extra clusters are discarded until the “best” number of clusters is found <span class="citation" data-cites="Sin2020Unsup">(<a href="#ref-Sin2020Unsup" role="doc-biblioref">Sinaga and Yang 2020</a>)</span>.</p>
<p>Other researchers have developed methods utilizing data density to determine the K-value, approximate better initial cluster centroids, and detect outliers. For one proposed variation of the K-means algorithm, first, regional density is calculated using a CLIQUE grid (CLustering In QUEst). In the CLIQUE grid, each dimension is divided into equal parts and the number of data points is calculated within each cell. Cells with counts above a defined threshold are defined as dense units, and adjacent dense units are connected to determine regional density. Noise in areas of low density is removed. Next, a density-based clustering algorithm based on the Clustering by Fast Search and Find of Density Peaks (CFSFDP) algorithm is used to calculate the local density of each point to determine initial cluster centers. This method can be used with datasets of any shape and does not require that a K-value be initialized <span class="citation" data-cites="Xu2020AnImproved">(<a href="#ref-Xu2020AnImproved" role="doc-biblioref">Xu et al. 2020</a>)</span>.</p>
</section>
</section>
<section id="methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Methods</h1>
Below diagram illustrates how the convergence is achieved in K-Means in several iterations.<br>
<br>

<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmeans.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image Source: ©Anand</figcaption><p></p>
</figure>
</div>
</center>
<p><br>
There are multiple iterations performed with different initial cluster centers. However, in each round of the iteration, following steps are performed to achieve convergence<span class="citation" data-cites="ste2008Selective">(<a href="#ref-ste2008Selective" role="doc-biblioref">Stefanowski 2008</a>)</span>:</p>
<ul>
<li>A random selection is made to assign initial centers (Shown as K1, K2 and K3)</li>
<li>Distance between these initial centers and other points are analyzed. Points are assigned to appropriate clusters based on their distance from these center points</li>
<li>New cluster centers are sought by finding the mean of the newly formed clusters. You can see how K1, K2 and K3 are shifting in this step</li>
<li>Steps A, B and C are repeated in multiple iterations until there is no shift detected in the cluster centers K, K2 and K3</li>
</ul>
<p>Let’s look at the mathematical implementation of this algorithm<span class="citation" data-cites="yul2020astudy">(<a href="#ref-yul2020astudy" role="doc-biblioref">Yulin 2020</a>)</span>,</p>
<p><strong>Proximity Measures</strong></p>
<p>K-means calculates proximity between data points and centroids to place the data in appropriate cluster. There are several methods to calculate this proximity and the choice of the method plays a critical role in defining the shape of the cluster. <strong><em>Euclidean distance</em></strong> measurement is the most general method used.</p>
<p><span class="math display">\[
D(x, y) = \sqrt{\sum_{i = 1}^{n}{(x_i - y_i)^2}}
\]</span></p>
<p><strong>Algorithm</strong></p>
<p>Suppose there is a dataset D that contains n data points and it was decided that there will be k clusters (and hence k initial cluster centers).</p>
<p><span class="math display">\[
Z_j(I), j = 1, 2, 3,...k.
\]</span></p>
<p>Calculate the Euclidean distance between each data point and the cluster center, <span class="math inline">\(D(x_i, Z_j(I)), i = 1, 2, ...n; j = 1, 2,...k.\)</span>, if below is satisfied:</p>
<p><span class="math display">\[
D(x_i, Z_k(I)) = min{D(x_i, Z_j(I)), j = 1, 2,...n}
\]</span></p>
<p>Now, calculate the new cluster center by calculating the error square sum criterion function <strong>J</strong>: changes</p>
<p><span class="math display">\[
J = \sum_{j = 1}^{k}\sum_{k = 1}^{n_j}||X_k^{(j)}-Z_j(I)||^2
\]</span></p>
</section>
<section id="analysis-and-results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Analysis and Results</h1>
<div class="cell">

</div>
<section id="dataset-description" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="dataset-description"><span class="header-section-number">3.1</span> Dataset Description</h2>
<p>For the customer segmentation, we will be using a data set that contains all the transactions that has occurred for a UK-based non-store online retail between 01/12/2009 and 09/12/2011. The company mainly sells unique all-occasion gift-ware. Many customers of the company are wholesalers. The company was established in 80s as a storefront and relied on direct mailing catalogues and taken order over phone. In recent years, the company launched a website and shifted completely to a web based online retail to take technological advantage of customer-centric targeted marketing approach<span class="citation" data-cites="online2010Chen">(<a href="#ref-online2010Chen" role="doc-biblioref">Chen 2010</a>)</span>.</p>
<p>The customer transactions dataset has 8 variables as shown in below data definition table.</p>
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>Data Definition</caption>
 <thead>
  <tr>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Attribute </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Type </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Description </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Invoice </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Invoice number. A 6-digit integral number uniquely assigned to each transaction. If this code starts with the letter `c`, it indicates a cancellation. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> StockCode </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Product (item) code. A 5-digit integral number uniquely assigned to each distinct product. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Description </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Product (item) name. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Quantity </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> The quantities of each product (item) per transaction. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> InvoiceDate </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Invice date and time. The day and time when a transaction was generated. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Price </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Product price per unit in sterling (£). </td>
  </tr>
  <tr>
   <td style="text-align:left;"> CustomerID </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Customer number. A 5-digit integral number uniquely assigned to each customer. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Country </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Country name. The name of the country where a customer resides. </td>
  </tr>
</tbody>
</table>

</div>
</section>
<section id="load-and-preview-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="load-and-preview-data"><span class="header-section-number">3.2</span> Load and Preview Data</h2>
<p>Load the dataset and summarize column statistics.</p>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Invoice </th>
   <th style="text-align:left;"> StockCode </th>
   <th style="text-align:left;"> Description </th>
   <th style="text-align:right;"> Quantity </th>
   <th style="text-align:left;"> InvoiceDate </th>
   <th style="text-align:right;"> Price </th>
   <th style="text-align:right;"> CustomerID </th>
   <th style="text-align:left;"> Country </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 85048 </td>
   <td style="text-align:left;"> 15CM CHRISTMAS GLASS BALL 20 LIGHTS </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 6.95 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 79323P </td>
   <td style="text-align:left;"> PINK CHERRY LIGHTS </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 6.75 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 79323W </td>
   <td style="text-align:left;"> WHITE CHERRY LIGHTS </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 6.75 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 22041 </td>
   <td style="text-align:left;"> RECORD FRAME 7" SINGLE SIZE </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 21232 </td>
   <td style="text-align:left;"> STRAWBERRY CERAMIC TRINKET BOX </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 1.25 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 22064 </td>
   <td style="text-align:left;"> PINK DOUGHNUT TRINKET POT </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 1.65 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Let us check the distribution of each field by doing univariate analysis.</p>
<p>Plot:</p>
<ul>
<li>Bar chart for categorical attributes</li>
<li>Histogram for numeric attributes</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the visualizations, we get a good amount of information about the structure of our chosen data. Below are the observations:</p>
<ol type="A">
<li>The Quantity is heavily skewed right and most of the transactions involved a quantity in the range of 1 to 5</li>
<li>The unit Price is also skewed right and most of the items have unit price between 1 and 4</li>
<li>The item with StockCode 85123A was sold most</li>
<li>Most of the customers belong to United Kingdom</li>
</ol>
</section>
<section id="data-preparation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">3.3</span> Data Preparation</h2>
<p>Before we prepare the data, let’s take a look at the summary and see if there are any missing values or other trends.</p>
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>Summary of Data</caption>
 <thead>
  <tr>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;">  </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> N </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Missing </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Mean </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> SD </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Min </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Q1 </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Median </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Q3 </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Max </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Quantity </td>
   <td style="text-align:center;"> 525461 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:left;"> 10.34 </td>
   <td style="text-align:center;"> 107.42 </td>
   <td style="text-align:center;"> -9600.00 </td>
   <td style="text-align:left;"> 1.00 </td>
   <td style="text-align:center;"> 3.0 </td>
   <td style="text-align:center;"> 10.00 </td>
   <td style="text-align:left;"> 19152.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Price </td>
   <td style="text-align:center;"> 525461 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:left;"> 4.69 </td>
   <td style="text-align:center;"> 146.13 </td>
   <td style="text-align:center;"> -53594.36 </td>
   <td style="text-align:left;"> 1.25 </td>
   <td style="text-align:center;"> 2.1 </td>
   <td style="text-align:center;"> 4.21 </td>
   <td style="text-align:left;"> 25111.09 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Customer Id </td>
   <td style="text-align:center;"> 417534 </td>
   <td style="text-align:center;"> 107927 </td>
   <td style="text-align:left;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:left;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:left;"> - </td>
  </tr>
</tbody>
</table>

</div>
<p>For conducting our analysis, we will be applying below listed data pre-processing steps on the original dataset:</p>
<ol type="1">
<li>The CustomerID contains unique Id for each unique Customer. However, we have 107,927 customers with no customer ids. We will be removing these customer before starting our analysis.</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove missing value</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">na.omit</span>(df, <span class="at">cols=</span><span class="st">"CustomerID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, the total records are 417, 534</p>
<ol start="2" type="1">
<li>Select appropriate attributes that helps in our analysis - <em>CustomerID</em>, <em>Invoice</em>, <em>Quantity</em>, <em>InvoiceDate</em> and <em>Price</em></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove description</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">subset</span>(df, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Description, Country, StockCode) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>Create a new attribute <em>Amount</em>. This will help in clustering these customers by the total amount spent. Group the data by customer id to get each unique customer and the total amount spent by them</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Amount <span class="ot">=</span> data<span class="sc">$</span>Quantity <span class="sc">*</span> data<span class="sc">$</span>Price</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>customer_monetary <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Amount =</span> <span class="fu">sum</span>(Amount)))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># customer_monetary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="4" type="1">
<li>Group the data by customer id to get each unique customer and the number of times (<em>Frequency</em>) they visited the store (by counting their numebr of invoices)</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>customer_frequency <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Invoice =</span> <span class="fu">n</span>()))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(customer_frequency)[<span class="fu">names</span>(customer_frequency) <span class="sc">==</span> <span class="st">"Invoice"</span>] <span class="ot">&lt;-</span> <span class="st">"Frequency"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># customer_frequency</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="5" type="1">
<li>Create a new attribute <em>LastSeen</em>. This will be calculated by subtracting the InvoiceDate from the max(InvoiceDate) and will show how many days have passed since the customer was last seen shopping. Group the data by customer id to get each unique customer and the minimum of the LastSeen.</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data$LastSeen = as.numeric(max(data$InvoiceDate) - data$InvoiceDate)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>LastSeen <span class="ot">=</span><span class="fu">as.integer</span>(<span class="fu">difftime</span>(<span class="fu">max</span>(data<span class="sc">$</span>InvoiceDate), data<span class="sc">$</span>InvoiceDate, <span class="at">units =</span> <span class="st">"days"</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>customer_lastseen <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">LastSeen =</span> <span class="fu">min</span>(LastSeen)))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># head(customer_lastseen)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(customer_lastseen)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="6" type="1">
<li>Merge the above data frames to get unique customer and their total amount, frequency of visit to the store and the LastSeen shopping in the store</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>customer <span class="ot">&lt;-</span> <span class="fu">merge</span>(customer_monetary, customer_frequency, <span class="at">by =</span> <span class="st">'CustomerID'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>customer <span class="ot">&lt;-</span> <span class="fu">merge</span>(customer, customer_lastseen, <span class="at">by =</span> <span class="st">'CustomerID'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(customer)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(customer)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(customer)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="7" type="1">
<li>Detect outliers and remove them. To create meaningful clusters, we will be removing outliers from numeric columns Amount, Invoice and LastSeen</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">melt</span>(customer[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>variable), <span class="at">outlier.colour =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at the above graph, there are outliers that need to be addressed to get accurate clustering results.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create detect outlier function</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>detect_outlier <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate first quantile</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    Quantile1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs=</span>.<span class="dv">25</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate third quantile</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    Quantile3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs=</span>.<span class="dv">75</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate inter quartile range</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    IQR <span class="ot">=</span> Quantile3<span class="sc">-</span>Quantile1</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return true or false</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">&gt;</span> Quantile3 <span class="sc">+</span> (IQR<span class="sc">*</span><span class="fl">1.5</span>) <span class="sc">|</span> x <span class="sc">&lt;</span> Quantile1 <span class="sc">-</span> (IQR<span class="sc">*</span><span class="fl">1.5</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create remove outlier function</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>remove_outlier <span class="ot">&lt;-</span> <span class="cf">function</span>(dataframe,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">columns=</span><span class="fu">names</span>(dataframe)) {</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for loop to traverse in columns vector</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (col <span class="cf">in</span> columns) {</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># remove observation if it satisfies outlier function</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        dataframe <span class="ot">&lt;-</span> dataframe[<span class="sc">!</span><span class="fu">detect_outlier</span>(dataframe[[col]]), ]</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(dataframe)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print("Remove outliers")</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(dataframe)</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># detect_outlier(customer$Amount)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>customer <span class="ot">&lt;-</span> <span class="fu">remove_outlier</span>(customer, <span class="fu">c</span>(<span class="st">'Amount'</span>,<span class="st">'Frequency'</span>,<span class="st">'LastSeen'</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(customer)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># customer</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(customer)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, after removing outliers and cleaning up the data, we see normal distribution of the Amount, Frequency and LastSeen columns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">melt</span>(customer[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>variable), <span class="at">outlier.colour =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="8" type="1">
<li>Scale the data. Since K-Means utilizes the proximity of data points based on Euclidean distance, it is important to reconcile all dimensions into a standard scale.</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>customer_details <span class="ot">&lt;-</span> customer</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>customer <span class="ot">&lt;-</span>  customer <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>CustomerID)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># scale numeric attributes</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>customer_scaled <span class="ot">&lt;-</span> customer <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"Amount"</span>, <span class="st">"Frequency"</span>, <span class="st">"LastSeen"</span>), <span class="sc">~</span>(<span class="fu">scale</span>(.) <span class="sc">%&gt;%</span> as.vector))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># head(customer_scaled)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(customer_scaled)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!--
9. Remove time component from the *InvoiceDate*. This will help in grouping same day transactions without considering what time the transaction occur as long as the day is the same.
 

::: {.cell}

```{.r .cell-code}
# #remove time component from date in InvoiceDate
# data$InvoiceDate = as.Date(data$InvoiceDate)
# #Convert Invoice date to Unix Epoc time
# data$InvoiceDate <- as.numeric(as.POSIXct(data$InvoiceDate))
```
:::

-->
</section>
<section id="target-dataset-analysis" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="target-dataset-analysis"><span class="header-section-number">3.4</span> Target Dataset Analysis</h2>
<p>We started our analysis with total 525461 records but after preparing and cleansing the data, we are left with total 3674 records to be analyzed.</p>
<!-- ```{r}
summarize(customer)
nrow(customer)
summary(customer)
``` -->
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>Target Data Definition</caption>
 <thead>
  <tr>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Attribute </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Type </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Description </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> CustomerID </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Customer number. A 5-digit integral number uniquely assigned to each customer. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Amount </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Total Amount spent by each unique customer </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Frequency </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Number of times customer made purchases bases on their invoice. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LastSeen </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Days elapsed since the customer was last seen shopping. </td>
  </tr>
</tbody>
</table>

</div>
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>Summary of Target Dataset (3674 Records)</caption>
 <thead>
  <tr>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;">  </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Mean </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Min </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Q1 </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Median </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Q3 </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Max </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Amount </td>
   <td style="text-align:center;"> 776.5 </td>
   <td style="text-align:center;"> -1598.7 </td>
   <td style="text-align:left;"> 241.5 </td>
   <td style="text-align:center;"> 515.1 </td>
   <td style="text-align:center;"> 1091.4 </td>
   <td style="text-align:left;"> 3685.1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Frequency </td>
   <td style="text-align:center;"> 48.15 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:left;"> 15.0 </td>
   <td style="text-align:center;"> 34.0 </td>
   <td style="text-align:center;"> 70.0 </td>
   <td style="text-align:left;"> 183.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LastSeen </td>
   <td style="text-align:center;"> 101.8 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:left;"> 23.0 </td>
   <td style="text-align:center;"> 62.0 </td>
   <td style="text-align:center;"> 163.0 </td>
   <td style="text-align:left;"> 373.0 </td>
  </tr>
</tbody>
</table>

</div>
</section>
<section id="statistical-modeling" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="statistical-modeling"><span class="header-section-number">3.5</span> Statistical Modeling</h2>
<section id="number-of-clusters-k" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="number-of-clusters-k"><span class="header-section-number">3.5.1</span> Number of clusters (K)</h3>
<p>One of the challenges in the K-Means clustering is determining initial value of K to ensure the resulting solution actually represents the underlying structure in the data. The reliability and the performance of a clustering algorithm is directly affected by the initial choice of the number of clusters (K).</p>
<section id="elbow-method" class="level4" data-number="3.5.1.1">
<h4 data-number="3.5.1.1" class="anchored" data-anchor-id="elbow-method"><span class="header-section-number">3.5.1.1</span> Elbow Method</h4>
<p>We will be using a popular method called <em>Elbow Method</em> to determine the optimal value of K. The underlying idea behind this method is that it calculates values of cost with changing K. As the value of K increases, the cluster will have fewer data points and the distortion (within cluster sum of square) will decrease. The larger number of clusters (and hence the lesser number of data points within the cluster) implies the data points are closer to the centroid. So, the point where this distortion declines the most is the elbow point.<span class="citation" data-cites="ste2011Choosing">(<a href="#ref-ste2011Choosing" role="doc-biblioref">STEINLEY 2011</a>)</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(customer_scaled, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">3</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Elbow Method"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="silhouette-method" class="level4" data-number="3.5.1.2">
<h4 data-number="3.5.1.2" class="anchored" data-anchor-id="silhouette-method"><span class="header-section-number">3.5.1.2</span> Silhouette Method</h4>
<p>Another way to find the optimal number of clusters in K-Means is Silhouette Method. We will be using it to double check the results we obtained from the above Elbow method. The silhouette method calculates a coefficient (called silhouette coefficient) which is a measure of how similar a data point is within-cluster (cohesion) compared to other clusters (separation).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(customer_scaled, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>)<span class="sc">+</span> <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Silhouette Method"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="gap-statistic-method" class="level4" data-number="3.5.1.3">
<h4 data-number="3.5.1.3" class="anchored" data-anchor-id="gap-statistic-method"><span class="header-section-number">3.5.1.3</span> Gap Statistic Method</h4>
<p>The basic idea of the Gap Statistics is to choose the number of K, where the biggest jump in within-cluster distance occurred, based on the overall behavior of uniformly drawn samples.<span class="citation" data-cites="tibs2001Gap">(<a href="#ref-tibs2001Gap" role="doc-biblioref">R. Tibshirani and Hastie 2001</a>)</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(customer_scaled, <span class="at">FUN =</span> kmeans, <span class="at">nstart =</span> <span class="dv">25</span>, <span class="at">K.max =</span> <span class="dv">10</span>, <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above Elbow, Silhouette and Gap Statistics graphs we can observe the elbow point is at ‘3’. So, we can pick 3 as our k value for number of clusters.</p>
<p><span class="math display">\[
K = 3
\]</span></p>
</section>
</section>
<section id="k-means-model" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="k-means-model"><span class="header-section-number">3.5.2</span> K-Means Model</h3>
<p>Now, we will create the K-Means model for K = 3.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute k-means with k = 3</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>m1.kmean <span class="ot">&lt;-</span> customer_scaled <span class="sc">%&gt;%</span> <span class="fu">kmeans</span>(k, <span class="at">iter.max =</span> <span class="dv">20</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#nstart option that attempts multiple initial configurations and reports on the best one</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># m1.kmean$cluster</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Add Clusters to the original dataframe</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>customer<span class="sc">$</span>Cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(m1.kmean<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>From the above model, we can observe that 3 clusters are formed with sizes 1807, 953, 914.</p>
<p>Now, we can extract the clusters and add to our initial data to do some descriptive statistics at the cluster level. Below table summarizes the original dataset grouped by clusters to show the mean of the variables:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>clustStats <span class="ot">&lt;-</span> customer <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cluster) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="st">"mean"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>clustStats <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Cluster </th>
   <th style="text-align:right;"> Amount </th>
   <th style="text-align:right;"> Frequency </th>
   <th style="text-align:right;"> LastSeen </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 514.2098 </td>
   <td style="text-align:right;"> 32.46375 </td>
   <td style="text-align:right;"> 51.45102 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 309.8873 </td>
   <td style="text-align:right;"> 21.64953 </td>
   <td style="text-align:right;"> 251.48478 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 1781.5403 </td>
   <td style="text-align:right;"> 106.80197 </td>
   <td style="text-align:right;"> 45.15536 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># centers &lt;- data.frame(c(1:3), m1.kmean$centers)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># names(centers)[names(centers) == "c.1.3."] &lt;- "Cluster"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># centers</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#customer</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- plot_ly(customer, x=~Amount, y=~Frequency,</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># z=~LastSeen, color=~Cluster) %&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#      add_markers(size=1.5)</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print(p)</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(m1.kmean, <span class="at">data =</span> customer_scaled,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above graph shows the clusters created using all columns of customer dataframe using the first two principle components to define the X-Y coordinates of each observation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(m1.kmean, <span class="at">data =</span> customer_scaled,<span class="at">choose.vars =</span> <span class="fu">c</span>(<span class="st">"LastSeen"</span>,<span class="st">"Amount"</span>),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>             )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(m1.kmean, <span class="at">data =</span> customer_scaled,<span class="at">choose.vars =</span> <span class="fu">c</span>(<span class="st">"Frequency"</span>,<span class="st">"Amount"</span>),</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>             )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(m1.kmean, <span class="at">data =</span> customer_scaled,<span class="at">choose.vars =</span> <span class="fu">c</span>(<span class="st">"LastSeen"</span>,<span class="st">"Frequency"</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>             )        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> colors[<span class="fu">as.numeric</span>(m1.kmean<span class="sc">$</span>cluster)]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>s3d <span class="ot">&lt;-</span> <span class="fu">scatterplot3d</span>(customer_scaled, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">color=</span>colors)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"top"</span>,<span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">"Cluster"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span>  <span class="fu">c</span>(<span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>), <span class="at">pch =</span> <span class="dv">16</span>)   </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>s3d<span class="sc">$</span><span class="fu">points3d</span>(m1.kmean<span class="sc">$</span>centers,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">pch =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>customer <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Cluster, <span class="at">y=</span>Amount, <span class="at">fill=</span>Cluster)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()<span class="sc">+</span>  <span class="fu">theme_classic</span>()  <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Clusters based on Amount Spent"</span>, <span class="at">subtitle =</span> <span class="st">"K-Means Model m1.kmeans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Customers in Cluster# 3 are spending more whereas cluster 2 customers are spending the least.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>customer <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Cluster, <span class="at">y=</span>Frequency, <span class="at">fill=</span>Cluster)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Clusters based on Number of transactions"</span>, <span class="at">subtitle =</span> <span class="st">"K-Means Model m1.kmeans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Customers in Cluster# 3 are most frequent customers indicating that the frequent customers spend the most.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>customer <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Cluster, <span class="at">y=</span>LastSeen, <span class="at">fill=</span>Cluster)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Clusters based on customer last seen shopping"</span>, <span class="at">subtitle =</span> <span class="st">"K-Means Model m1.kmeans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Customers in Cluster 2 have not been seen shopping recently. The most recently seen shoppers are in Cluster 3 and that also explains why they have spent more money and bought frequently.</p>
</section>
<section id="analysis" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="analysis"><span class="header-section-number">3.5.3</span> Analysis</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="RFM.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image Source: ©Anand</figcaption><p></p>
</figure>
</div>
<p>For this business, its a matter of grave concern that most of their customers (49%) are not finding what they want. The shop would need to revisit their strategy of what brand/item they should be selling in the online shop to convert visits into revenue.</p>
</section>
</section>
</section>
<section id="conlusion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Conlusion</h1>
</section>
<section id="references" class="level1 unnumbered" data-number="5">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">5 References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Ahmed2020TheK" class="csl-entry" role="doc-biblioentry">
Ahmed, Mohiuddin, Raihan Seraj, and Syed Mohammed Shamsul Islam. 2020. <span>“The k-Means Algorithm: A Comprehensive Survey and Performance Evaluation.”</span> <em>Electronics</em> 9 (8). <a href="https://doi.org/10.3390/electronics9081295">https://doi.org/10.3390/electronics9081295</a>.
</div>
<div id="ref-online2010Chen" class="csl-entry" role="doc-biblioentry">
Chen, Dr. Daqing. 2010. <span>“Online Retail II Data Set.”</span> School of Engineering, London South Bank University, London SE1 0AA, UK. <a href="https://archive.ics.uci.edu/ml/datasets/Online+Retail+II">https://archive.ics.uci.edu/ml/datasets/Online+Retail+II</a>.
</div>
<div id="ref-Jie2020Review" class="csl-entry" role="doc-biblioentry">
Jie, Chen, Zhang Jiyue, Wu Junhui, Wu Yusheng, Si Huiping, and Lin Kaiyan. 2020. <span>“Review on the Research of k-Means Clustering Algorithm in Big Data.”</span> In <em>2020 IEEE 3rd International Conference on Electronics and Communication Engineering (ICECE)</em>, 107–11. <a href="https://doi.org/10.1109/ICECE51594.2020.9353036">https://doi.org/10.1109/ICECE51594.2020.9353036</a>.
</div>
<div id="ref-Nag2022Auto" class="csl-entry" role="doc-biblioentry">
Nagaraj, P, S Selva Birunda, R Venkatesh, V Muneeswaran, S Krishna Narayanan, U Dhannu Shree, and B Sunethra. 2022. <span>“Automatic and Adaptive Segmentation of Customer in r Framework Using k-Means Clustering Technique.”</span> In <em>2022 International Conference on Computer Communication and Informatics (ICCCI)</em>, 1–5. <a href="https://doi.org/10.1109/ICCCI54379.2022.9741067">https://doi.org/10.1109/ICCCI54379.2022.9741067</a>.
</div>
<div id="ref-tibs2001Gap" class="csl-entry" role="doc-biblioentry">
R. Tibshirani, G. Walther, and T. Hastie. 2001. <span>“Estimating the Number of Clusters in a Data Set via Gap Statistic.”</span> <em>Journal of the Royal Statistical Society. Series B, Statistical Methodology</em> 63 (2): 411–23. <a href="https://doi.org/10.1111/1467-9868.00293">https://doi.org/10.1111/1467-9868.00293</a>.
</div>
<div id="ref-Sin2020Unsup" class="csl-entry" role="doc-biblioentry">
Sinaga, Kristina P., and Miin-Shen Yang. 2020. <span>“Unsupervised k-Means Clustering Algorithm.”</span> <em>IEEE Access</em> 8: 80716–27. <a href="https://doi.org/10.1109/ACCESS.2020.2988796">https://doi.org/10.1109/ACCESS.2020.2988796</a>.
</div>
<div id="ref-ste2008Selective" class="csl-entry" role="doc-biblioentry">
Stefanowski, S., &amp; Wilk. 2008. <span>“Selective Pre-Processing of Imbalanced Data for Improving Classification Performance.”</span> <em>Data Warehousing and Knowledge Discovery</em>, 283–92. <a href="https://doi.org/10.1007/978-3-540-85836-2_27">https://doi.org/10.1007/978-3-540-85836-2_27</a>.
</div>
<div id="ref-ste2011Choosing" class="csl-entry" role="doc-biblioentry">
STEINLEY, M. J, &amp; BRUSCO. 2011. <span>“Choosing the Number of Clusters in k-Means Clustering.”</span> <em>Psychological Methods</em> 16 (3): 285–97.
</div>
<div id="ref-tab2022kmeans" class="csl-entry" role="doc-biblioentry">
Tabianan, S., Velu. 2022. <span>“K-Means Clustering Approach for Intelligent Customer Segmentation Using Customer Purchase Behavior Data.”</span> <em>Analytical Methods</em> 14 (12): 7243. <a href="https://doi.org/10.3390/su14127243">https://doi.org/10.3390/su14127243</a>.
</div>
<div id="ref-Xu2020AnImproved" class="csl-entry" role="doc-biblioentry">
Xu, Hui, Shunyu Yao, Qianyun Li, and Zhiwei Ye. 2020. <span>“An Improved k-Means Clustering Algorithm.”</span> In <em>2020 IEEE 5th International Symposium on Smart and Wireless Systems Within the Conferences on Intelligent Data Acquisition and Advanced Computing Systems (IDAACS-SWS)</em>, 1–5. <a href="https://doi.org/10.1109/IDAACS-SWS50031.2020.9297060">https://doi.org/10.1109/IDAACS-SWS50031.2020.9297060</a>.
</div>
<div id="ref-yul2020astudy" class="csl-entry" role="doc-biblioentry">
Yulin, &amp; Qianying, D. 2020. <span>“A Study on e-Commerce Customer Segmentation Management Based on Improved k-Means Algorithm.”</span> <em>Information Systems and e-Business Management</em> 18 (4): 497–510. <a href="https://doi.org/10.1007/s10257-018-0381-3">https://doi.org/10.1007/s10257-018-0381-3</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>