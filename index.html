<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anand Pandey">
<meta name="author" content="Katie Hidden">
<meta name="author" content="Akash Chandra">
<meta name="dcterms.date" content="2022-11-06">
<meta name="description" content="An unsupervised learning algorithm ">

<title>K-Means Clustering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="index_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="index_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span style="color: #0366D6;">K-Means Clustering</span></h1>
</div>

<div>
  <div class="description">
    An unsupervised learning algorithm<br>
    <hr>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Anand Pandey </p>
             <p>Katie Hidden </p>
             <p>Akash Chandra </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<hr>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>We have often heard of training machine learning models with labeled data. Imagine if there is a massive volume of data with no labels and we want to come up with a scalable approach to process these data and find insights. Difficult as it may seem, this is possible with clustering algorithms like K-Means.</p>
<p>Unsupervised machine learning is a type of algorithm that works on detecting patterns from a dataset when outcomes are not known or labeled. In unsupervised learning models it is not possible to train the algorithm the way we would normally do in case of supervised learning. This is because the data is neither classified nor labeled and allows the algorithm to act on the information without supervision. An unsupervised algorithm works on discovering the underlying hidden structure, pattern or association of the data and that helps the model in clustering or grouping the data without any human intervention.</p>
<p>The main goal of this paper is to discuss the concept and underlying methodology of one the unsupervised algorithm called K-Means clustering. We will also discuss how K-Means can be leveraged in real time applications like customer segmentation <span class="citation" data-cites="yul2020astudy">(<a href="#ref-yul2020astudy" role="doc-biblioref">Yulin 2020</a>)</span>. In this paper, we will also be discussing various limitations and bottlenecks of K-Means clustering algorithm and would suggest some improved algorithms to overcome these limitations.</p>
<section id="k-means-clustering" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="k-means-clustering"><span class="header-section-number">1.1</span> K-Means Clustering</h2>
<p>K-means clustering is used for grouping similar observations together by minimizing the Euclidean distance between them. It uses “centroids”. Initially, it randomly chooses K different points in the data and assigns every data point to their nearest centroid. Once all of them are assigned, it moves the centroid to the average of points assigned to it. When the assigned centroid stops changing, we get the converged data points in separate clusters.</p>
</section>
<section id="customer-segmentation" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="customer-segmentation"><span class="header-section-number">1.2</span> Customer Segmentation</h2>
<p>Customer segmentation helps divide customers into different groups based on their common set of characteristics (like age, gender, spending habit, credit score, etc.) that helps in targeting those customers for marketing purposes. The primary focus of customer segmentation is to come up with strategies that helps in identifying customers in each category in order to maximize the profit by optimizing the services and products. Therefore, customer segmentation helps businesses in promoting the right product to the right customer to increase profits<span class="citation" data-cites="tab2022kmeans">(<a href="#ref-tab2022kmeans" role="doc-biblioref">Tabianan 2022</a>)</span>.</p>
<p>Customer segmentation is not only helpful for business but also helps customers by providing them information relevant to their needs. If customers receive too much information which is not related to their regular purchase or their interest on the products, it can cause confusion on deciding their needs. This might lead their customers to give up on purchasing the items they required and effect the business to lose their potential customers. The clustering analysis will help to categorize the customer according to their spending habit, purchase habit or specific product or brand the customers interested in. Customer segmentation can be broadly divided into four factors - demographic psychographic, behavioral, and geographic<span class="citation" data-cites="tab2022kmeans">(<a href="#ref-tab2022kmeans" role="doc-biblioref">Tabianan 2022</a>)</span>. In this paper, customer behavioral factor has been primarily focused.</p>
<p>K-Means clustering algorithm can help effectively extract groups of customers with similar characteristics and purchasing behavior which in turn helps businesses to specify their differentiated marketing campaign and become more customer-centric.<span class="citation" data-cites="yul2020astudy">(<a href="#ref-yul2020astudy" role="doc-biblioref">Yulin 2020</a>)</span></p>
<center>
<img src="CustomerSegmentation.png" class="img-fluid">
</center>
</section>
<section id="limitations" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="limitations"><span class="header-section-number">1.3</span> Limitations</h2>
<p>One of the challenges of K-means clustering is determining an appropriate number of clusters, or the K-value. While this can be a challenge for datasets of any size, it is especially difficult to determine a reasonable K-value with very large datasets and those with high dimensionality, since it is much more difficult to visualize the data. The K-means clustering algorithm was developed in the 1960s, before the advent of the internet and the resulting era of big data, and as such, it was not designed for datasets of such large scale <span class="citation" data-cites="Sin2020Unsup">(<a href="#ref-Sin2020Unsup" role="doc-biblioref">Sinaga and Yang 2020</a>)</span>.</p>
<p>Another limitation is the algorithm’s tendency to converge to only the local optimum solution, rather than the global minimum. The algorithm is sensitive to the initial centroid values selected, to noise, and to outliers, all of which can cause cluster centers to veer off, resulting in a local minimum solution <span class="citation" data-cites="Jie2020Review">(<a href="#ref-Jie2020Review" role="doc-biblioref">Jie et al. 2020</a>)</span>.</p>
<p>The shape of data clusters is another concern. K-means clustering typically classifies n-hyperspherically shaped data well but is less successful at classifying irregularly shaped clusters <span class="citation" data-cites="Ahmed2020TheK">(<a href="#ref-Ahmed2020TheK" role="doc-biblioref">Ahmed, Seraj, and Islam 2020</a>)</span>.</p>
</section>
<section id="improved-k-means" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="improved-k-means"><span class="header-section-number">1.4</span> Improved K-Means</h2>
<p>Researchers have developed methods to address the limitations of the K-means clustering algorithm.</p>
<p>One popular approach to determining an appropriate K-value is to use the “elbow method”. This method estimates K by calculating the sum of squared error (SSE) for a range of K-values; the SSE values are plotted against the K values. The point before the change in SSE becomes visually minimal (the elbow) is selected as the K-value <span class="citation" data-cites="Nag2022Auto">(<a href="#ref-Nag2022Auto" role="doc-biblioref">Nagaraj et al. 2022</a>)</span>.</p>
<p>To overcome the challenge of selecting a K-value for very large datasets, researchers have developed a “novel unsupervised k-means (U-k-means) clustering algorithm.” This algorithm has a built-in process to determine the K-value and perform K-means clustering using the concept of entropy, and thus does not require any parameter initialization by the user. On the first iteration, the K-value is initialized as the number of data points. Gradually, extra clusters are discarded until the “best” number of clusters is found <span class="citation" data-cites="Sin2020Unsup">(<a href="#ref-Sin2020Unsup" role="doc-biblioref">Sinaga and Yang 2020</a>)</span>.</p>
<p>Other researchers have developed methods utilizing data density to determine the K-value, approximate better initial cluster centroids, and detect outliers. For one proposed variation of the K-means algorithm, first, regional density is calculated using a CLIQUE grid (CLustering In QUEst). In the CLIQUE grid, each dimension is divided into equal parts and the number of data points is calculated within each cell. Cells with counts above a defined threshold are defined as dense units, and adjacent dense units are connected to determine regional density. Noise in areas of low density is removed. Next, a density-based clustering algorithm based on the Clustering by Fast Search and Find of Density Peaks (CFSFDP) algorithm is used to calculate the local density of each point to determine initial cluster centers. This method can be used with datasets of any shape and does not require that a K-value be initialized <span class="citation" data-cites="Xu2020AnImproved">(<a href="#ref-Xu2020AnImproved" role="doc-biblioref">Xu et al. 2020</a>)</span>.</p>
</section>
</section>
<section id="methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Methods</h1>
</section>
<section id="analysis-and-results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Analysis and Results</h1>
<div class="cell">

</div>
<section id="dataset-description" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="dataset-description"><span class="header-section-number">3.1</span> Dataset Description</h2>
<p>For the customer segmentation, we will be using a data set that contains all the transactions that has occurred for a UK-based non-store online retail between 01/12/2009 and 09/12/2011. The company mainly sells unique all-occasion gift-ware. Many customers of the company are wholesalers. The company was established in 80s as a storefront and relied on direct mailing catalogues and taken order over phone. In recent years, the company launched a website and shifted completely to a web based online retail to take technological advantage of customer-centric targeted marketing approach<span class="citation" data-cites="online2010Chen">(<a href="#ref-online2010Chen" role="doc-biblioref">Chen 2010</a>)</span>.</p>
<p>The customer transactions dataset has 8 variables as shown in below data definition table.</p>
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>Data Definition</caption>
 <thead>
  <tr>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Attribute </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Type </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Description </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Invoice </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Invoice number. A 6-digit integral number uniquely assigned to each transaction. If this code starts with the letter `c`, it indicates a cancellation. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> StockCode </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Product (item) code. A 5-digit integral number uniquely assigned to each distinct product. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Description </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Product (item) name. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Quantity </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> The quantities of each product (item) per transaction. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> InvoiceDate </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Invice date and time. The day and time when a transaction was generated. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Price </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Product price per unit in sterling (£). </td>
  </tr>
  <tr>
   <td style="text-align:left;"> CustomerID </td>
   <td style="text-align:center;"> Numeric </td>
   <td style="text-align:left;"> Customer number. A 5-digit integral number uniquely assigned to each customer. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Country </td>
   <td style="text-align:center;"> Nominal </td>
   <td style="text-align:left;"> Country name. The name of the country where a customer resides. </td>
  </tr>
</tbody>
</table>

</div>
</section>
<section id="load-and-preview-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="load-and-preview-data"><span class="header-section-number">3.2</span> Load and Preview Data</h2>
<p>Load the dataset and summarize column statistics.</p>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Invoice </th>
   <th style="text-align:left;"> StockCode </th>
   <th style="text-align:left;"> Description </th>
   <th style="text-align:right;"> Quantity </th>
   <th style="text-align:left;"> InvoiceDate </th>
   <th style="text-align:right;"> Price </th>
   <th style="text-align:right;"> CustomerID </th>
   <th style="text-align:left;"> Country </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 85048 </td>
   <td style="text-align:left;"> 15CM CHRISTMAS GLASS BALL 20 LIGHTS </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 6.95 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 79323P </td>
   <td style="text-align:left;"> PINK CHERRY LIGHTS </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 6.75 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 79323W </td>
   <td style="text-align:left;"> WHITE CHERRY LIGHTS </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 6.75 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 22041 </td>
   <td style="text-align:left;"> RECORD FRAME 7" SINGLE SIZE </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 2.10 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 21232 </td>
   <td style="text-align:left;"> STRAWBERRY CERAMIC TRINKET BOX </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 1.25 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 489434 </td>
   <td style="text-align:left;"> 22064 </td>
   <td style="text-align:left;"> PINK DOUGHNUT TRINKET POT </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:left;"> 2009-12-01 07:45:00 </td>
   <td style="text-align:right;"> 1.65 </td>
   <td style="text-align:right;"> 13085 </td>
   <td style="text-align:left;"> United Kingdom </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Let us check the distribution of each field by doing univariate analysis.</p>
<p>Plot:</p>
<ul>
<li>Bar chart for categorical attributes</li>
<li>Histogram for numeric attributes</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the visualizations, we get a good amount of information about the structure of our chosen data. Below are the observations:</p>
<ol type="A">
<li>The Quantity is heavily skewed right and most of the transactions involved a quantity in the range of 1 to 5</li>
<li>The unit Price is also skewed right and most of the items have unit price between 1 and 4</li>
<li>The item with StockCode 85123A was sold most</li>
<li>Most of the customers belong to United Kingdom</li>
</ol>
</section>
<section id="data-preparation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">3.3</span> Data Preparation</h2>
<p>Before we prepare the data, let’s take a look at the summary and see if there are any missing values or other trends.</p>
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>Summary of Data</caption>
 <thead>
  <tr>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;">  </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> N </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Missing </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Mean </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> SD </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Min </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Q1 </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Median </th>
   <th style="text-align:center;font-weight: bold;color: white !important;background-color: #666666 !important;"> Q3 </th>
   <th style="text-align:left;font-weight: bold;color: white !important;background-color: #666666 !important;"> Max </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Quantity </td>
   <td style="text-align:center;"> 525461 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:left;"> 10.34 </td>
   <td style="text-align:center;"> 107.42 </td>
   <td style="text-align:center;"> -9600.00 </td>
   <td style="text-align:left;"> 1.00 </td>
   <td style="text-align:center;"> 3.0 </td>
   <td style="text-align:center;"> 10.00 </td>
   <td style="text-align:left;"> 19152.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Price </td>
   <td style="text-align:center;"> 525461 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:left;"> 4.69 </td>
   <td style="text-align:center;"> 146.13 </td>
   <td style="text-align:center;"> -53594.36 </td>
   <td style="text-align:left;"> 1.25 </td>
   <td style="text-align:center;"> 2.1 </td>
   <td style="text-align:center;"> 4.21 </td>
   <td style="text-align:left;"> 25111.09 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Customer Id </td>
   <td style="text-align:center;"> 417534 </td>
   <td style="text-align:center;"> 107927 </td>
   <td style="text-align:left;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:left;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:left;"> - </td>
  </tr>
</tbody>
</table>

</div>
<p>For conducting our analysis, we will be applying below listed data pre-processing steps on the original dataset:</p>
<ol type="1">
<li>The CustomerID contains unique Id for each unique Customer. However, we have 107,927 customers with no customer ids. We will be removing these customer before starting our analysis.</li>
<li>Select appropriate attributes that helps in our analysis - <em>Invoice</em>, <em>StockCode</em>,<em>CustomerID</em>, <em>Quantity</em>,<em>InvoiceDate</em>,<em>Price</em>,<em>Country</em></li>
<li>Create a new attribute <em>Amount</em>. This will help in clustering these customers by the total amount spent.</li>
<li>Remove time component from the <em>InvoiceDate</em>. This will help in grouping same day transactions without considering what time the transaction occur as long as the day is the same.</li>
<li>Create a new attribute <em>LastSeen</em>. This will be calculated by subtracting the InvoiceDate from the max(InvoiceDate) and will show how many days have passed since the customer was last seen shopping.</li>
<li>Detect outliers and remove them. To create meaningful clusters, we will be removing outliers from numeric columns Amount, Invoice and LastSeen</li>
<li>Scale the data. Since K-Means utilizes the proximity of data points based on Euclidean distance, it is important to reconcile all dimensions into a standard scale.</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove missing value</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">na.omit</span>(df, <span class="at">cols=</span><span class="st">"CustomerID"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#remove description</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">subset</span>(df, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Description) )</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#create a new attribute Amount</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'Amount'</span>] <span class="ot">=</span> data[<span class="st">'Quantity'</span>] <span class="sc">*</span> data[<span class="st">'Price'</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#remove time component from date in InvoiceDate</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>InvoiceDate <span class="ot">=</span> <span class="fu">as.Date</span>(data<span class="sc">$</span>InvoiceDate)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#create a new attribute LastSeen</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'LastSeen'</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">max</span>(data<span class="sc">$</span>InvoiceDate) <span class="sc">-</span> data<span class="sc">$</span>InvoiceDate)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Detect outliers and remove them</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#scale numeric attributes</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), scale))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-and-vizualisation" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="data-and-vizualisation"><span class="header-section-number">3.4</span> Data and Vizualisation</h2>
</section>
<section id="statistical-modeling" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="statistical-modeling"><span class="header-section-number">3.5</span> Statistical Modeling</h2>
</section>
</section>
<section id="conlusion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Conlusion</h1>
</section>
<section id="references" class="level1 unnumbered" data-number="5">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">5 References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Ahmed2020TheK" class="csl-entry" role="doc-biblioentry">
Ahmed, Mohiuddin, Raihan Seraj, and Syed Mohammed Shamsul Islam. 2020. <span>“The k-Means Algorithm: A Comprehensive Survey and Performance Evaluation.”</span> <em>Electronics</em> 9 (8). <a href="https://doi.org/10.3390/electronics9081295">https://doi.org/10.3390/electronics9081295</a>.
</div>
<div id="ref-online2010Chen" class="csl-entry" role="doc-biblioentry">
Chen, Dr. Daqing. 2010. <span>“Online Retail II Data Set.”</span> School of Engineering, London South Bank University, London SE1 0AA, UK. <a href="https://archive.ics.uci.edu/ml/datasets/Online+Retail+II">https://archive.ics.uci.edu/ml/datasets/Online+Retail+II</a>.
</div>
<div id="ref-Jie2020Review" class="csl-entry" role="doc-biblioentry">
Jie, Chen, Zhang Jiyue, Wu Junhui, Wu Yusheng, Si Huiping, and Lin Kaiyan. 2020. <span>“Review on the Research of k-Means Clustering Algorithm in Big Data.”</span> In <em>2020 IEEE 3rd International Conference on Electronics and Communication Engineering (ICECE)</em>, 107–11. <a href="https://doi.org/10.1109/ICECE51594.2020.9353036">https://doi.org/10.1109/ICECE51594.2020.9353036</a>.
</div>
<div id="ref-Nag2022Auto" class="csl-entry" role="doc-biblioentry">
Nagaraj, P, S Selva Birunda, R Venkatesh, V Muneeswaran, S Krishna Narayanan, U Dhannu Shree, and B Sunethra. 2022. <span>“Automatic and Adaptive Segmentation of Customer in r Framework Using k-Means Clustering Technique.”</span> In <em>2022 International Conference on Computer Communication and Informatics (ICCCI)</em>, 1–5. <a href="https://doi.org/10.1109/ICCCI54379.2022.9741067">https://doi.org/10.1109/ICCCI54379.2022.9741067</a>.
</div>
<div id="ref-Sin2020Unsup" class="csl-entry" role="doc-biblioentry">
Sinaga, Kristina P., and Miin-Shen Yang. 2020. <span>“Unsupervised k-Means Clustering Algorithm.”</span> <em>IEEE Access</em> 8: 80716–27. <a href="https://doi.org/10.1109/ACCESS.2020.2988796">https://doi.org/10.1109/ACCESS.2020.2988796</a>.
</div>
<div id="ref-tab2022kmeans" class="csl-entry" role="doc-biblioentry">
Tabianan, S., Velu. 2022. <span>“K-Means Clustering Approach for Intelligent Customer Segmentation Using Customer Purchase Behavior Data.”</span> <em>Analytical Methods</em> 14 (12): 7243. <a href="https://doi.org/10.3390/su14127243">https://doi.org/10.3390/su14127243</a>.
</div>
<div id="ref-Xu2020AnImproved" class="csl-entry" role="doc-biblioentry">
Xu, Hui, Shunyu Yao, Qianyun Li, and Zhiwei Ye. 2020. <span>“An Improved k-Means Clustering Algorithm.”</span> In <em>2020 IEEE 5th International Symposium on Smart and Wireless Systems Within the Conferences on Intelligent Data Acquisition and Advanced Computing Systems (IDAACS-SWS)</em>, 1–5. <a href="https://doi.org/10.1109/IDAACS-SWS50031.2020.9297060">https://doi.org/10.1109/IDAACS-SWS50031.2020.9297060</a>.
</div>
<div id="ref-yul2020astudy" class="csl-entry" role="doc-biblioentry">
Yulin, &amp; Qianying, D. 2020. <span>“A Study on e-Commerce Customer Segmentation Management Based on Improved k-Means Algorithm.”</span> <em>Information Systems and e-Business Management</em> 18 (4): 497–510. <a href="https://doi.org/10.1007/s10257-018-0381-3">https://doi.org/10.1007/s10257-018-0381-3</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>